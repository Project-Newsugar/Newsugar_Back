# 모니터링 & 운영 전략

## 1. 툴 스택 (Hybrid)
AWS 관리형이랑 오픈소스 섞어서 씀. 가성비+편의성 세팅.

| 구분 | 도구 | 용도 |
|---|---|---|
| **로그 저장** | **CloudWatch Logs** | 로그 중앙 보관 |
| **로그 수집** | **Fluent Bit** | EKS 로그 긁어서 CloudWatch로 쏘는 역할 |
| **트레이싱** | **AWS X-Ray** | API 요청 경로 추적 (어디서 느린지 찾기) |
| **시각화** | **Grafana** | 대시보드 (AWS Managed 추천) |
| **배포** | **ArgoCD** | GitOps 자동 배포 |

## 2. 핵심 지표 (이것만 보면 됨)
1. **ALB (로드밸런서)**: 5XX 에러율, 응답 속도 (P95)
2. **EKS (서버)**: 파드 개수, CPU/메모리 사용률
3. **RDS (DB)**: CPU, 커넥션 수

## 3. 로그 수집 경로
- **앱 로그**: Spring Boot -> 콘솔 출력 -> Fluent Bit -> CloudWatch
- **접속 로그**: ALB -> S3 저장 (장애 분석용)
- **감사 로그**: CloudTrail (누가 뭐 건드렸는지 기록)

## 4. 알람 정책 (최소화)
시도 때도 없이 울리면 안 보니까 진짜 급한 것만 설정.

| 상황 | 알림 | 대응 |
|---|---|---|
| **서버 에러 (5XX)** | Slack | 로그 확인 후 핫픽스 |
| **CPU 과부하** | Slack | 스케일링 설정 확인 |
| **DB 병목** | Slack | 쿼리 튜닝 필요 |
| **헬스체크 실패** | **전화/PagerDuty** | **비상 사태 (DR 가동 고려)** |

## 5. 배포 파이프라인 (GitOps)
1. **GitHub**: 코드 푸시
2. **Action**: 도커 빌드 -> ECR 업로드
3. **ArgoCD**: 새 이미지 감지 -> EKS 배포 (자동)
   - **Dev**: 바로 배포
   - **Prod**: Blue/Green 무중단 배포
